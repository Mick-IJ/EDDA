---
title: "Assignment 3"
author: "Maud van den Berg, Mick IJzoer, Tirza IJpma"
date: \today
output: pdf_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
knitr::opts_chunk$set(fig.width=6, fig.height=5, fig.align = "center") 
```

## Exercise 1
a)\newline
The activity has a significant effect F(2, 72)=19.42, p < .000. on the longevity.
The fruitflies in the high-condition lives the shortest (3.60212), fruitflies that are isolated live longer (4.11935), and in the low-condition they are a duration in between (3.81437).
```{r, include=FALSE}
fruitdata = read.table('fruitflies.txt', header=TRUE)
fruitdata$loglongevity = log(fruitdata$longevity)
attach(fruitdata)
```
```{r, fig1, fig.height = 4, fig.width = 4, echo=FALSE} 
boxplot(loglongevity~activity, main = "Boxplot activities")
contrasts(activity) = contr.sum
loglongaov = lm(loglongevity~activity)
anova(loglongaov)
```
```{r, include=FALSE}
summary(loglongaov)
```

b)\newline
The effect of activity is significant F(2, 71)=25.71, p < .000.
The fruitflies in high-condition live shorter, isolated-condition longer and low-condition somewhere in between.
The estimates are:
high = 3.675217
isolated = 4.085197
low = 3.960907
```{r, echo=FALSE}
loglongaov2 = lm(loglongevity~thorax+activity)
anova(loglongaov2)
```
```{r, include=FALSE}
summary(loglongaov2)
```

c)\newline
First the ANCOVA is carried out with the interaction of activity and thorax. This resulted in a non-significant interaction effect (p = 0.154). To continue, a ANCOVA without interaction is carried out. The ANCOVA without interaction resulted in a significant effect of thorax F(1, 71) = 94.37, p < .000, where a longer thorax results in a longer longevity.
```{r, fig2, fig.height = 4, fig.width = 6, echo=FALSE} 
loglongaov3 = lm(loglongevity~activity*thorax)
anova(loglongaov3)
plot(loglongevity~thorax, pch=unclass(activity), main = "Interaction between sexual activity and thorax length")
abline(lm(loglongevity~thorax, data=fruitdata[fruitdata$activity == 'high', ]), col='blue')
abline(lm(loglongevity~thorax, data=fruitdata[fruitdata$activity == 'low', ]), col='red')
abline(lm(loglongevity~thorax, data=fruitdata[fruitdata$activity == 'isolated', ]), col='green')
legend(0.85, 3.5, legend=c('high', 'low', 'isolated'), col=c('blue', 'red', 'green'), pch=c(1,2,3))
```

```{r, echo=FALSE}
loglongaov4 = lm(loglongevity~activity+thorax)
anova(loglongaov4)
```
```{r, include=FALSE}
summary(loglongaov3)
summary(loglongaov4)
```

d)\newline
The ANCOVA with thorax included in the model, has a explained variance of 70.9%, compared with the model without thorax, with an explained variance of 33.2%. 
The analyses without thorax is not wrong, if beforehand is not known if the thorax has an influence and the only goal is to know if sexual acitivity is of influence on longevity. However, if it is known that there  is or coule be an effect of thorax length, it should be taken into account to do a right analyses. 

e)\newline
Investigating the QQ-plot and the plot of the residuals against the fitted values, it can be seen that the data is normally distributed and it does not show heteroscedasticity, because no pattern can be seen in the plot.
```{r, echo=FALSE}
par(mfrow=c(2,2))
qqnorm(residuals(loglongaov4), main = "QQ-plot residuals")
hist(residuals(loglongaov4), main = "Histogram residuals")
plot(fitted(loglongaov4), residuals(loglongaov4), main = "Residuals against fited values")
```
```{r, include=FALSE}
shapiro.test(residuals(loglongaov4))
```

f)\newline
The same QQ-plot and residuals plot is carried out, with the original longevity data. This resulted in a normally distributed data. However, the plot of the residuals against the fitted values showed some pattern of heteroscedasticity.
```{r, echo=FALSE}
longaov = lm(longevity~activity+thorax)
anova(longaov)
par(mfrow=c(2,2))
qqnorm(residuals(longaov), main = "QQ-plot residuals")
hist(residuals(longaov), main = "Histogram residuals")
plot(fitted(longaov), residuals(longaov), main = "Residuals against fitted values")
```
```{r, include=FALSE}
summary(longaov)
shapiro.test(residuals(longaov))
```




