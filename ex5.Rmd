---
title: "ex5"
output: pdf_document
---
\usepackage{newunicodechar}
\newunicodechar{ﬁ}{fi}
\newunicodechar{ﬀ}{ff}
```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## Exercise 5
a)\newline
```{r}
#to check distribution
par(mfrow= c(2,3))
qqnorm(expend); qqnorm(bad); qqnorm(crime); qqnorm(lawyers); qqnorm(employ); qqnorm(pop)
par(mfrow= c(2,3))
hist(expend); hist(bad); hist(crime); hist(lawyers); hist(employ); hist(pop)
#to check collinearity
pairs(crimetable)
round(cor(crimetable[2:7]),2)
```





b)\newline
```{r, include=FALSE}
crimetable = read.table('expensescrime.txt', header = T)
par(mfrow = c (1,1))
boxplot(crimetable)
#step-up method
summary(lm(expend~bad,data=crimetable)) #r2 = 0.6964
summary(lm(expend~crime,data=crimetable)) #r2 = 0.1119
summary(lm(expend~lawyers,data=crimetable)) #r2 = 0.9373
summary(lm(expend~employ,data=crimetable)) # r2 = 0.954
summary(lm(expend~pop,data=crimetable)) # r2 = 0.9073
#highest r2 = employ, and add all the others and look for highest again
summary(lm(expend~employ+lawyers,data=crimetable)) #r2= 0.9632 and sign.
summary(lm(expend~employ+bad,data=crimetable)) # r2 0.9551 and not sign.
summary(lm(expend~employ+crime,data=crimetable)) #r2 = 0.9551 and not sign.
summary(lm(expend~employ+pop,data=crimetable)) #r2 = 0.9543 and not sign.
#highest R2 = lawyers and only significant, so add this one. 
```
```{r}
summary(lm(expend~employ+lawyers,data=crimetable))
```
```{r, include=FALSE}
#step-down method
summary(lm(expend~bad+crime+lawyers+employ+pop,data=crimetable))
#crime is most insiginificant, so take out
summary(lm(expend~bad+lawyers+employ+pop,data=crimetable))
#pop out
summary(lm(expend~bad+lawyers+employ,data=crimetable))
#bad out
summary(lm(expend~lawyers+employ,data=crimetable))
#significant, same answer as step-up
```

Both step-up and step-down methods are carried out, to find the best model.
The step-up method resulted in the signiﬁcant explanatory variables 'employ' and 'lawyers'.
(waardes geven? F-statistic: 627.7 on 2 and 48 DF,  p-value: < 2.2e-16, R-squared:  0.9632).
The resulting model of the step-up method is: expend = -1.107e+02 + 2.971e-02*employ - 2.686e-02*lawyers + error.

The step-down method resulted in the same signiﬁcant explanatory variables, so the two methods yield the same model.

c)\newline
```{r, echo=FALSE}
# 1. scatter plot: plot Y against each Xk separately (this yields overall picture, and shows outlying values)
#see a)
```
```{r, echo=FALSE}
#2.Scatter plot of residuals against eachXkin the model separately.
par(mfrow = c (1,5))
badlm = lm(expend~bad); plot(residuals(badlm),bad)
crimelm = lm(expend~crime); plot(residuals(crimelm),crime)
lawyerslm = lm(expend~lawyers); plot(residuals(lawyerslm),lawyers)
employlm = lm(expend~employ); plot(residuals(employlm),employ)
poplm = lm(expend~pop); plot(residuals(poplm),pop)

```

```{r}
#3.Added variable plot of residuals of Xj against residuals of Y with omitted Xj.
#DOES ORDER MATTER?
par(mfrow = c (2,3))
#bad
x=residuals(lm(bad~crime+lawyers+employ+pop)) 
y=residuals(lm(expend~crime+lawyers+employ+pop)) 
plot(x,y,main="Added variable plot for bad", xlab="residual of bad", ylab="residual of expend")
#crime
x=residuals(lm(crime~lawyers+employ+pop+bad)) 
y=residuals(lm(expend~bad+lawyers+employ+pop)) 
plot(x,y,main="Added variable plot for crime", xlab="residual of crime", ylab="residual of expend")
#lawyers
x=residuals(lm(lawyers~crime+employ+pop+bad)) 
y=residuals(lm(expend~bad+crime+employ+pop)) 
plot(x,y,main="Added variable plot for lawyers", xlab="residual of lawyers", ylab="residual of expend")
#employ
x=residuals(lm(employ~lawyers+crime+pop+bad)) 
y=residuals(lm(expend~bad+lawyers+crime+pop)) 
plot(x,y,main="Added variable plot for employ", xlab="residual of employ", ylab="residual of expend")
#pop
x=residuals(lm(pop~lawyers+employ+crime+bad)) 
y=residuals(lm(expend~bad+lawyers+employ+crime)) 
plot(x,y,main="Added variable plot for pop", xlab="residual of pop", ylab="residual of expend")
```

```{r}
#4.Scatter plot of residuals against eachXknot inthe model separately. #plot(residuals(bodyfatlm),Triceps)> plot(residuals(bodyfatlm),Midarm)
expendlm = lm(expend~lawyers+employ,data=crimetable)
par(mfrow = c(1,3))
plot(residuals(expendlm), bad)
plot(residuals(expendlm), crime)
plot(residuals(expendlm), pop)
```
```{r}
#5.Scatter plot of residuals againstY(andˆY).> 
plot(residuals(expendlm),expend)
plot(residuals(expendlm),fitted(expendlm))
```


```{r}
#6.NormalQQ-plot of the residuals. 
qqnorm(residuals(expendlm))
shapiro.test(residuals(expendlm))
```

