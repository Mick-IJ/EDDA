---
title: "Assignment 2"
author: "Tirza IJpma"
date: "2-3-2020"
output: pdf_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

Exercise 3
a) 
```{r}
setwd("C:/Users/tirza/Documents/Artificial Intelligence/6. EDDA/Assignments/Assignment2")
cow = read.table('cow.txt', header=T)
attach(cow)
qqnorm(milk) #normal
hist(milk) #twijfel
boxplot(milk) #normal
shapiro.test(milk) #not significant, so normally distributed
#moet dit (ook) van de residuals?
```

First, it is investigated whether the data the outcome y (milk) is normally distributed. According to the QQ-plot, histogram, boxplot it is assumed that the data is normally dsitributed. In addition, a Shapiro-Wilk-test is carried out, which also confirmed a normally distributed data.
An ordinary "fixed effects" model is carried out. From this ANOVA it is concluded that there is a difference in milk production between the two treatments of 0.51 liter and this is not significant (p= 0.516536)

```{r}
cow$id = factor(cow$id)
cow$per = factor(cow$per)
contrasts(cow$treatment) = contr.sum
contrasts(cow$per) = contr.sum
contrasts(cow$id) = contr.sum
contrasts(cow$order) = contr.sum

cowlm=lm(milk~treatment+order+per+id,data=cow)
anova(cowlm)
summary(cowlm)

treatment1 = 35.1222+0.2550
treatment2 = 35.1222-0.2550
difference = treatment1-treatment2
```

remark - model assumptions:
qqnorm(residuals(cowlm))
plot(fitted(cowlm), residuals(cowlm), main = "Residuals against fitted values") #normally distributed
bartlett.test(milk~treatment) #equal variances
observations are dependent of eachother #because ID is also taken as a dependant factor in the anova 


b) To investigate what is the difference in treatment but with the cow effect as a random effect, a "mixel model" is carried out. To investigate if the effect of treatment is significant in this model, an ANOVA is carried out. 
```{r}
library(lme4)
cowlmer = lmer(milk~treatment+order+per+(1|id),data=cow,REML=FALSE)
summary(cowlmer)

#comparing results a and b 
cowlmer1 = lmer(milk~order+per+(1|id),data=cow,REML=FALSE)
anova(cowlmer1 , cowlmer)
# no significant chisquare, no effefct of treatment
```

